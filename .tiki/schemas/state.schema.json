{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Tiki State",
  "description": "Tracks which issue is active. Phase progress is in plan files.",
  "type": "object",
  "properties": {
    "activeIssue": {
      "type": ["integer", "null"],
      "description": "Currently active issue number, or null if idle"
    },
    "activeIssueTitle": {
      "type": ["string", "null"],
      "description": "Title of active issue for display"
    },
    "status": {
      "type": "string",
      "enum": ["idle", "executing", "paused", "failed"],
      "description": "Current execution status"
    },
    "startedAt": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "When current execution started"
    },
    "lastActivity": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "Last state update timestamp"
    },
    "lastCompletedIssue": {
      "type": ["integer", "null"],
      "description": "Most recently completed issue number"
    },
    "lastCompletedAt": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "When last issue was completed"
    },
    "errorMessage": {
      "type": ["string", "null"],
      "description": "Error message if status is failed"
    },
    "currentPhase": {
      "type": ["integer", "null"],
      "description": "Current phase number (for Tiki.Desktop compatibility)"
    },
    "totalPhases": {
      "type": ["integer", "null"],
      "description": "Total phases (for Tiki.Desktop compatibility)"
    }
  },
  "required": ["status"]
}
